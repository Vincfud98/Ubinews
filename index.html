<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UbiNews | Inteligência Diária</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Merriweather:ital,wght@0,300;0,400;0,700;1,400&family=Playfair+Display:ital,wght@0,500;0,600;0,700;0,900;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                        reading: ['Merriweather', 'serif'],
                    },
                    colors: {
                        brand: {
                            gold: "#c39364",
                            dark: "#1a1a1a",
                            light: "#f4f4f5"
                        }
                    },
                    boxShadow: {
                        'card': '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03)',
                        'card-hover': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                    }
                }
            }
        }
    </script>

    <style>
        /* Google Translate Customization */
        .goog-te-banner-frame { display: none !important; }
        body { top: 0px !important; }
        .goog-te-gadget span { display: none !important; }
        .goog-te-gadget { font-size: 0 !important; color: transparent !important; }
        /* Mantemos o combo acessível no DOM mas invisível */
        .goog-te-combo { opacity: 0; height: 0; width: 0; overflow: hidden; position: absolute; pointer-events: none; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #c39364; border-radius: 3px; }
        
        /* Line Clamp for 3 lines */
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Tab Animations */
        .tab-content { display: none; animation: fadeIn 0.3s ease; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* Loader */
        .loader-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #c39364;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Flags */
        .flag-icon { width: 20px; height: 14px; display: inline-block; background-size: cover; border-radius: 2px; border: 1px solid #ddd; vertical-align: middle; }
    </style>
</head>
<body class="bg-[#fcfcfc] text-slate-800 antialiased font-sans selection:bg-brand-gold selection:text-white">

    <header class="fixed top-0 w-full z-40 bg-white/90 backdrop-blur-md border-b border-slate-200 shadow-sm transition-all duration-300" id="main-header">
        <div class="max-w-[1600px] mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-4">
                <button onclick="toggleMobileMenu()" class="lg:hidden text-slate-600 hover:text-brand-gold">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <div class="flex items-center gap-2 group cursor-pointer" onclick="window.scrollTo(0,0)">
                    <img src="https://yt3.googleusercontent.com/ytc/AIdro_lHPfbyFhxIP0ptIdo8mkYx1E5rjl9u_S6OaTQpwzdWfAQ=s900-c-k-c0x00ffffff-no-rj" alt="Logo UbiNews" class="h-9 w-9 rounded object-cover shadow-sm group-hover:opacity-80 transition-opacity">
                    <div class="flex flex-col">
                        <span class="font-serif font-bold text-xl leading-none tracking-tight">Ubi<span class="text-brand-gold">News</span></span>
                        <span class="text-[0.6rem] uppercase tracking-[0.2em] text-slate-400 font-bold">Inteligência Diária</span>
                    </div>
                </div>
            </div>

            <div class="hidden md:flex flex-1 max-w-md mx-8 relative">
                <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-slate-400 text-sm"></i>
                <input type="text" id="searchInput" placeholder="Buscar por tema, país ou palavra-chave..." 
                       class="w-full pl-10 pr-4 py-2 bg-slate-100 border-none rounded-full text-sm focus:ring-2 focus:ring-brand-gold/50 focus:bg-white transition-all outline-none">
            </div>

            <div class="flex items-center gap-3">
                <div id="google_translate_element_header"></div>
                
                <div class="h-8 w-8 rounded-full bg-slate-200 overflow-hidden border border-slate-300 cursor-pointer">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=UbiUser" alt="User">
                </div>
            </div>
        </div>
    </header>

    <div class="flex pt-16 min-h-screen max-w-[1600px] mx-auto">
        
        <aside class="hidden lg:block w-72 fixed h-[calc(100vh-64px)] overflow-y-auto border-r border-slate-200 bg-white p-6 z-30">
            <h3 class="font-serif font-bold text-lg mb-6 flex items-center gap-2">
                <i class="fas fa-filter text-brand-gold text-sm"></i> Filtros
            </h3>

            <div class="mb-8">
                <h4 class="text-xs font-bold uppercase text-slate-400 tracking-widest mb-3">Região</h4>
                <div class="space-y-1" id="regionFilters">
                </div>
            </div>

            <div class="mb-8">
                <h4 class="text-xs font-bold uppercase text-slate-400 tracking-widest mb-3">Tema</h4>
                <div class="space-y-1" id="themeFilters">
                </div>
            </div>

            <div class="mb-8">
                <h4 class="text-xs font-bold uppercase text-slate-400 tracking-widest mb-3">Tags Populares</h4>
                <div class="flex flex-wrap gap-2" id="tagFilters">
                </div>
            </div>
            
            <button onclick="clearFilters()" class="w-full py-2 text-xs font-bold text-slate-400 hover:text-red-500 transition-colors border-t border-slate-100 mt-4">
                Limpar Filtros
            </button>
        </aside>

        <div id="mobileMenu" class="fixed inset-0 z-50 bg-white transform -translate-x-full transition-transform duration-300 lg:hidden overflow-y-auto">
            <div class="p-4 border-b flex justify-between items-center">
                <span class="font-serif font-bold text-xl">Filtros</span>
                <button onclick="toggleMobileMenu()"><i class="fas fa-times text-xl"></i></button>
            </div>
            <div class="p-6">
                <div id="mobileFiltersTarget"></div>
            </div>
        </div>

        <main class="flex-1 lg:ml-72 p-4 md:p-8 bg-[#fcfcfc]">
            
            <div class="mb-8 flex flex-col md:flex-row justify-between items-end gap-4 border-b border-slate-200 pb-4">
                <div>
                    <span class="text-xs font-bold text-brand-gold uppercase tracking-widest mb-1 block" id="currentDateDisplay"></span>
                    <h1 class="font-serif font-bold text-3xl md:text-4xl text-slate-900">Feed Diário</h1>
                </div>
                <div class="text-right">
                    <span class="text-2xl font-bold text-slate-900" id="newsCount">0</span>
                    <span class="text-sm text-slate-500">atualizações hoje</span>
                </div>
            </div>

            <div id="feedGrid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8">
            </div>
            
            <div id="emptyState" class="hidden text-center py-20">
                <div class="inline-block p-4 rounded-full bg-slate-100 mb-4"><i class="fas fa-search text-slate-400 text-2xl"></i></div>
                <h3 class="text-lg font-bold text-slate-700">Nenhum resultado encontrado</h3>
                <p class="text-slate-500">Tente ajustar os filtros ou sua busca.</p>
                <button onclick="clearFilters()" class="mt-4 text-brand-gold font-bold hover:underline">Limpar filtros</button>
            </div>
        </main>
    </div>

    <div id="newsModal" class="fixed inset-0 z-[60] hidden bg-white overflow-y-auto animate-[fadeIn_0.3s_ease]">
        
        <button onclick="closeNewsModal()" class="fixed top-6 right-6 z-50 h-10 w-10 bg-white/20 backdrop-blur-md hover:bg-white text-white hover:text-black rounded-full flex items-center justify-center transition-all shadow-lg border border-white/30">
            <i class="fas fa-times text-lg"></i>
        </button>

        <div class="relative w-full h-[60vh] md:h-[70vh] group">
            <img id="modalHeroImg" src="" class="w-full h-full object-cover" alt="Hero">
            <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent"></div>
            
            <div class="absolute bottom-0 left-0 w-full p-6 md:p-12 lg:p-20 max-w-5xl">
                <div class="flex items-center gap-3 mb-4">
                    <span id="modalCategory" class="px-3 py-1 bg-brand-gold text-white text-xs font-bold uppercase tracking-widest rounded-sm"></span>
                    <span id="modalDate" class="text-white/80 text-xs font-medium uppercase tracking-wider border-l border-white/30 pl-3"></span>
                </div>
                <h1 id="modalTitle" class="text-3xl md:text-5xl lg:text-6xl font-serif font-bold text-white leading-tight mb-4 drop-shadow-lg"></h1>
                <p id="modalSubtitle" class="text-lg md:text-xl text-white/90 font-light max-w-3xl leading-relaxed drop-shadow-md hidden md:block"></p>
            </div>
        </div>

        <div class="max-w-[1200px] mx-auto px-4 py-8 md:py-12 flex flex-col lg:flex-row gap-12">
            
            <div class="lg:w-3/4">
                
                <div class="sticky top-0 bg-white z-20 border-b border-slate-200 mb-8 pt-2">
                    <div class="flex gap-6 overflow-x-auto pb-px no-scrollbar" id="modalTabs">
                        <button class="tab-btn active text-sm font-bold uppercase tracking-wider py-3 border-b-2 border-brand-gold text-brand-gold" onclick="switchTab('tab-resumo')">Resumo & Texto</button>
                        <button class="tab-btn text-sm font-bold uppercase tracking-wider py-3 border-b-2 border-transparent text-slate-500 hover:text-slate-800" onclick="switchTab('tab-prova')">O Tema na Prova</button>
                        <button class="tab-btn text-sm font-bold uppercase tracking-wider py-3 border-b-2 border-transparent text-slate-500 hover:text-slate-800" onclick="switchTab('tab-analise')">Análise</button>
                        <button class="tab-btn text-sm font-bold uppercase tracking-wider py-3 border-b-2 border-transparent text-slate-500 hover:text-slate-800" onclick="switchTab('tab-historico')">Histórico</button>
                        <button class="tab-btn text-sm font-bold uppercase tracking-wider py-3 border-b-2 border-transparent text-slate-500 hover:text-slate-800" onclick="switchTab('tab-pontos')">Pontos Principais</button>
                    </div>
                </div>

                <div id="tab-resumo" class="tab-content active">
                    <div class="flex items-center justify-between mb-6 bg-slate-50 p-3 rounded-lg border border-slate-100">
                        <span class="text-xs font-bold text-slate-500 uppercase">Idioma do Texto:</span>
                        <div class="flex gap-2">
                            <button onclick="translateContent('pt')" class="hover:bg-white p-1 rounded shadow-sm transition"><div class="flag-icon" style="background-image: url('https://flagcdn.com/w40/br.png')"></div></button>
                            <button onclick="translateContent('en')" class="hover:bg-white p-1 rounded shadow-sm transition"><div class="flag-icon" style="background-image: url('https://flagcdn.com/w40/gb.png')"></div></button>
                            <button onclick="translateContent('es')" class="hover:bg-white p-1 rounded shadow-sm transition"><div class="flag-icon" style="background-image: url('https://flagcdn.com/w40/es.png')"></div></button>
                            <button onclick="translateContent('fr')" class="hover:bg-white p-1 rounded shadow-sm transition"><div class="flag-icon" style="background-image: url('https://flagcdn.com/w40/fr.png')"></div></button>
                        </div>
                    </div>

                    <div class="prose prose-lg prose-slate max-w-none font-reading text-slate-700 leading-loose">
                        <div class="mb-8 p-6 bg-[#fcfcfc] border-l-4 border-brand-gold rounded-r-lg italic text-slate-600 shadow-sm">
                            <h3 class="text-brand-gold not-italic font-bold text-sm uppercase mb-2">Resumo Executivo</h3>
                            <div id="modalSummary"></div>
                        </div>

                        <div class="mb-10 bg-slate-900 text-white rounded-xl p-6 flex flex-col md:flex-row items-center justify-between gap-4 shadow-lg shadow-slate-900/20 transform transition-all hover:scale-[1.01]">
                            <div>
                                <h4 class="text-brand-gold font-bold uppercase tracking-widest text-xs mb-2">
                                    <i class="fas fa-graduation-cap mr-1"></i> Área de Treinamento
                                </h4>
                                <h3 class="font-serif font-bold text-2xl mb-1">Simulado Geral do Dia</h3>
                                <p class="text-slate-400 text-sm max-w-lg leading-relaxed">
                                    Prepare-se com questões inéditas baseadas em <strong>todas as notícias</strong> do feed de hoje, abrangendo todos os tópicos.
                                </p>
                            </div>
                            <button class="flex-shrink-0 px-8 py-4 bg-brand-gold hover:bg-white hover:text-brand-gold text-white font-bold text-sm uppercase tracking-wider rounded-lg transition-all shadow-md group">
                                Começar Agora <i class="fas fa-arrow-right ml-2 group-hover:translate-x-1 transition-transform"></i>
                            </button>
                        </div>
                        <div id="modalFullText" class="mt-8 text-justify"></div>
                    </div>
                </div>

                <div id="tab-prova" class="tab-content">
                    <div class="bg-blue-50 border border-blue-100 rounded-xl p-8 mb-6">
                        <h3 class="font-serif font-bold text-2xl text-blue-900 mb-4 flex items-center gap-2">
                            <i class="fas fa-graduation-cap"></i> Incidência em Provas
                        </h3>
                        <div id="modalExamAnalysis" class="space-y-4 text-blue-800"></div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="p-4 border border-slate-200 rounded-lg">
                            <span class="text-xs font-bold text-slate-400 uppercase">Disciplinas Correlatas</span>
                            <div class="mt-2 flex flex-wrap gap-2" id="modalDisciplines"></div>
                        </div>
                    </div>
                </div>

                <div id="tab-analise" class="tab-content">
                    <div class="flex items-start gap-4 mb-8">
                        <div class="w-16 h-16 rounded-full bg-slate-200 overflow-hidden flex-shrink-0">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Professor" alt="Prof">
                        </div>
                        <div>
                            <h4 class="font-bold text-lg">Comentário do Especialista</h4>
                            <p class="text-slate-500 text-sm">Equipe UbiNews</p>
                        </div>
                    </div>
                    <div id="modalTeacherAnalysis" class="prose prose-slate max-w-none font-reading"></div>
                </div>

                <div id="tab-historico" class="tab-content">
                    <div class="relative pl-8 border-l-2 border-slate-200 space-y-8" id="modalTimeline">
                    </div>
                    <div id="modalHistoricalText" class="mt-8 prose prose-slate"></div>
                </div>

                <div id="tab-pontos" class="tab-content">
                    <div class="grid gap-4" id="modalKeyPoints">
                    </div>
                    <div class="mt-8">
                        <h4 class="font-bold text-lg mb-4">Glossário</h4>
                        <div id="modalGlossary" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                    </div>
                </div>

            </div>

            <div class="lg:w-1/4 space-y-8">
                
                <div class="bg-slate-50 rounded-xl p-6 border border-slate-200 shadow-sm sticky top-24">
                    <h3 class="font-serif font-bold text-xl mb-4 text-brand-gold flex items-center gap-2">
                        <i class="fas fa-map-signs"></i> Roadmap
                    </h3>

                    <div class="mb-6">
                        <h4 class="text-xs font-bold uppercase text-slate-900 mb-2">Espectro Político</h4>
                        <div id="modalSpectrum" class="space-y-3">
                            </div>
                    </div>

                    <div>
                        <h4 class="text-xs font-bold uppercase text-slate-900 mb-2">Plano de Estudos</h4>
                        <a href="#" class="block bg-brand-dark text-white p-3 rounded-lg text-center text-sm font-bold hover:bg-slate-800 transition-colors">
                            <i class="fas fa-play-circle mr-2"></i> Assistir Aula Relacionada
                        </a>
                        <a href="#" class="block text-center text-xs text-slate-500 mt-2 hover:text-brand-gold">
                            Ver Fascículo Ubique #42
                        </a>
                    </div>
                </div>

                <div>
                    <h4 class="font-serif font-bold text-lg mb-4">Pessoas de Interesse</h4>
                    <div class="flex flex-wrap gap-2" id="modalPeople">
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script>
        // --- DATA & CONFIG ---
        
        // Mapeamento de Filtros
        const REGIONS = [
            "América do Sul", "América do Norte", "América Central e Caribe", 
            "Europa", "Ásia e Oceania", "África", "Oriente Médio"
        ];
        
        const THEMES = [
            "Governança Global", "Economia e Comércio", "Segurança e Paz", 
            "Meio Ambiente", "Energia", "Migrações", "Direitos Humanos", 
            "Integração Regional", "Política Externa Brasileira"
        ];

        // --- DADOS COMPLETOS COM ESPECTRO POLÍTICO ---
        let newsData = [
            {
                id: 1,
                dateIso: "2025-09-19",
                category: "Segurança Internacional",
                title: "Veto dos EUA à paz e crise em Gaza reacendem debate sobre Estado palestino na ONU",
                imageUrl: "https://agro.insper.edu.br/storage/mediaarticles/November2023/7Yo8rXlPxUAlrV3i0jxC.png",
                summary: "Pela sexta vez, os Estados Unidos votaram no Conselho de Segurança da ONU uma resolução que exigia cessar-fogo imediato em Gaza, acesso humanitário e libertação de reféns. Na Assembleia em Nova York, a França deve oficializar o reconhecimento do Estado palestino, propondo relançar a solução dos dois Estados.",
                fullText: `Na Assembleia em Nova York, a França deve oficializar o reconhecimento do Estado palestino, propondo relançar a solução dos dois Estados. No Conselho de Segurança, uma resolução exigindo o fim das restrições à ajuda humanitária em Gaza, cessar-fogo permanente e libertação de reféns teve 14 votos favoráveis, mas foi vetada pelos EUA, que responsabilizam o Hamas e defendem o direito de Israel à autodefesa.\n\nA decisão provocou indignação entre outros países, agravada pela declaração da ONU sobre fome em Gaza e acusações de uma comissão independente de possíveis crimes genocidas por Israel. A iniciativa francesa, a ser anunciada em 22 de setembro, busca combinar segurança para Israel e isolamento do Hamas, com apoio de grupos de trabalho ocidentais e árabes. Especialistas avisam que, sem medidas concretas como sanções, o reconhecimento terá pouco efeito.\n\nObstáculos incluem resistência israelense, posições internas em países europeus e desafios na governança palestina, embora a cooperação com a Arábia Saudita seja vista como potencial influência de longo prazo. À luz das teorias realistas, a postura norte-americana e israelense evidencia a primazia de interesses de segurança e alianças estratégicas sobre normas humanitárias; já abordagens construtivistas destacam como narrativas, legitimações simbólicas (reconhecimento estatal) e campanhas diplomáticas remodelam identidades e normas, potencialmente alterando as expectativas de comportamento dos Estados.`,
                themes: "Segurança internacional e manutenção da paz, Agenda internacional",
                meta: "Fonte: RFI",
                region: "Oriente Médio",
                theme: "Segurança e Paz",
                tags: ["ONU", "Israel-Palestina", "EUA"],
                politicalView: {
                    left: "Critica o veto dos EUA como cumplicidade em violações de direitos humanos e 'genocídio'. Defende o reconhecimento imediato da Palestina e sanções a Israel.",
                    right: "Apoia o veto dos EUA como necessário para garantir a segurança de Israel e eliminar o Hamas. Vê o reconhecimento unilateral da Palestina como recompensa ao terrorismo."
                }
            },
            {
                id: 2,
                dateIso: "2025-09-16",
                category: "Comércio Internacional",
                title: "Acordo MERCOSUL-EFTA: Diversificação Estratégica",
                imageUrl: "https://www.infomoney.com.br/wp-content/uploads/2025/09/Captura-de-tela-2025-09-21-122234.png?quality=70",
                summary: "O acordo MERCOSUL-EFTA simboliza a busca do bloco sul-americano pela diversificação de parceiros comerciais. Pontos de atenção: eliminação de tarifas em 90% do comércio.",
                fullText: `Os Estados Membros do MERCOSUL e os Estados da EFTA assinaram um Acordo de Livre Comércio (ALC). O acordo abrange comércio de bens, serviços, investimentos e compras governamentais. A medida visa reduzir a dependência de grandes blocos tradicionais e aumentar a competitividade dos produtos sul-americanos na Europa rica (Suíça, Noruega, Islândia, Liechtenstein).`,
                themes: "Integração Regional; Mercosul",
                meta: "Fonte: MRE",
                region: "América do Sul",
                theme: "Economia e Comércio",
                tags: ["Mercosul", "EFTA", "Livre Comércio"],
                politicalView: {
                    left: "Vê com cautela a assimetria econômica; preocupa-se com o impacto na indústria nacional e defende proteção aos pequenos produtores e normas ambientais rígidas.",
                    right: "Celebra a abertura comercial, a redução de tarifas e o acesso a mercados de alta renda, defendendo a eficiência econômica e a modernização via competição."
                }
            },
            { 
                id: 3, 
                dateIso: "2025-12-07", 
                category: "Direitos Humanos", 
                title: "Refugiados Climáticos: Vácuo Jurídico", 
                imageUrl: "https://ogimg.infoglobo.com.br/in/24114871-be3-961/FT1086A/85882766_TOPSHOTA-womancarries-her-child-as-she-crosses-a-wooden-bridge-in-the-refugee-camp-of-Mo.jpg", 
                summary: "A crise no Chifre da África expõe a falta de proteção legal para 'refugiados climáticos' na Convenção de 1951.", 
                fullText: "O Alto Comissariado da ONU para Refugiados (ACNUR) emitiu um alerta urgente sobre o deslocamento forçado causado por secas extremas. Juristas debatem a expansão do conceito de refúgio para incluir causas ambientais, enfrentando resistência de países desenvolvidos temerosos de novas ondas migratórias.", 
                themes: "Direitos Humanos", 
                meta: "Fonte: ONU", 
                region: "África", 
                theme: "Migrações", 
                tags: ["Clima", "Refugiados", "ONU"],
                politicalView: {
                    left: "Defende a criação urgente do status jurídico de 'refugiado climático', argumentando que os países ricos (maiores poluidores) têm dívida histórica e dever de acolhimento.",
                    right: "Prioriza a soberania nacional e o controle de fronteiras. Prefere ajuda humanitária local ('in loco') em vez de facilitar a imigração em massa para o Norte Global."
                }
            },
            { 
                id: 4, 
                dateIso: "2025-12-02", 
                category: "Energia", 
                title: "Opep+ e a Geopolítica do Petróleo", 
                imageUrl: "https://www.portalviu.com.br/wp-content/uploads/2016/12/Petr%C3%B3leo-mundial1.jpg", 
                summary: "A extensão dos cortes de produção demonstra a autonomia estratégica da Opep+ frente ao Ocidente.", 
                fullText: "Em reunião ministerial decisiva, a Opep+ decidiu manter os cortes voluntários de produção. A medida visa sustentar os preços do barril em meio à desaceleração econômica global, desafiando as pressões dos EUA e da Europa para baixar custos de energia.", 
                themes: "Energia", 
                meta: "Fonte: Bloomberg", 
                region: "Oriente Médio", 
                theme: "Energia", 
                tags: ["Petróleo", "OPEP", "Arábia Saudita"],
                politicalView: {
                    left: "Critica a dependência global de combustíveis fósseis e o poder de cartéis energéticos. Defende aceleração da transição energética para reduzir a influência geopolítica da Opep.",
                    right: "Analisa sob a ótica do interesse nacional e realismo: países produtores têm o direito de gerir seus recursos. Foca na segurança energética e estabilidade de preços."
                }
            },
            { 
                id: 5, 
                dateIso: "2025-12-06", 
                category: "Política Externa", 
                title: "Venezuela: 'Cautela Construtiva'", 
                imageUrl: "https://admin.cnnbrasil.com.br/wp-content/uploads/sites/12/2024/12/Trump_Maduro.jpg?w=1200&h=900&crop=1", 
                summary: "A 'Cautela Construtiva' do Brasil busca manter canais de diálogo e estabilidade regional.", 
                fullText: "Após as eleições regionais contestadas, o Itamaraty adotou tom de 'cautela construtiva', evitando condenações abruptas para não perder a capacidade de interlocução, ao mesmo tempo em que cobra transparência nas atas eleitorais.", 
                themes: "América do Sul", 
                meta: "Fonte: Folha", 
                region: "América do Sul", 
                theme: "Política Externa Brasileira", 
                tags: ["Venezuela", "Itamaraty", "Eleições"],
                politicalView: {
                    left: "Apoia a não-intervenção e a autodeterminação dos povos. Defende o diálogo diplomático como única saída e rejeita sanções que punem a população.",
                    right: "Exige postura firme contra regimes autoritários. Critica a 'cautela' como complacência ideológica com ditaduras de esquerda e defende pressão internacional."
                }
            },
            { 
                id: 7, 
                dateIso: "2025-12-02", 
                category: "Energia", 
                title: "Opep+: Restrição de Oferta", 
                imageUrl: "https://s2-oglobo.glbimg.com/jRZgyO0Ak8Kwl3denhfc_tizmuA=/0x262:1920x1583/888x0/smart/filters:strip_icc()/i.s3.glbimg.com/v1/AUTH_da025474c0c44edd99332dddb09cabe8/internal_photos/bs/2024/T/3/kRvwHxSwuUdjHs9pU7gg/petroleo.jpg", 
                summary: "A restrição de oferta reafirma o papel do Estado na economia de energia.", 
                fullText: "Em reunião ministerial decisiva, a continuidade da restrição de oferta pela Arábia Saudita e Rússia sinaliza um alinhamento do 'Sul Global' energético, utilizando commodities como alavanca de poder político.", 
                themes: "Energia", 
                meta: "Fonte: FT", 
                region: "Oriente Médio", 
                theme: "Energia", 
                tags: ["Realismo", "Economia"],
                politicalView: {
                    left: "Vê a manobra como resistência à hegemonia ocidental, mas alerta para o impacto inflacionário nos mais pobres e a necessidade de soberania energética renovável.",
                    right: "Interpreta como jogo de mercado e soberania estatal. Defende que os países consumidores diversifiquem fornecedores e invistam em produção interna (ex: shale gas)."
                }
            },
            { 
                id: 9, 
                dateIso: "2025-12-11", 
                category: "Tecnologia", 
                title: "DREX e Soberania Monetária", 
                imageUrl: "https://seucreditodigital.com.br/wp-content/uploads/2025/11/drex-045.jpg", 
                summary: "O piloto do DREX reforça a soberania monetária estatal frente às criptomoedas.", 
                fullText: "O Banco Central do Brasil anunciou avanços no piloto do DREX (Real Digital). A moeda digital de banco central (CBDC) visa modernizar o sistema financeiro, permitindo contratos inteligentes, ao mesmo tempo que mantém o controle da política monetária nas mãos do Estado, contrapondo-se à descentralização das criptomoedas privadas.", 
                themes: "Economia", 
                meta: "Fonte: Valor", 
                region: "América do Sul", 
                theme: "Economia e Comércio", 
                tags: ["DREX", "Banco Central", "Digital"],
                politicalView: {
                    left: "Apoia o DREX como ferramenta de inclusão financeira, combate à lavagem de dinheiro e evasão fiscal, reforçando o papel regulador do Estado.",
                    right: "Expressa preocupação com a privacidade e o potencial de vigilância estatal excessiva sobre as transações individuais. Prefere moedas privadas ou descentralizadas."
                }
            },
            { 
                id: 10, 
                dateIso: "2025-12-03", 
                category: "Meio Ambiente", 
                title: "Tratado Global de Plásticos", 
                imageUrl: "https://apublica.org/wp-content/uploads/2024/12/CAPA-Producao-x-poluicao-as-disputas-que-travam-um-tratado-global-sobre-plasticos.jpg", 
                summary: "O INC-5 resultou em um 'regime híbrido', refletindo a vitória do lobby petroquímico.", 
                fullText: "A quinta e última rodada de negociações do Tratado Global de Plásticos terminou com um acordo menos ambicioso que o esperado. Países produtores de petróleo bloquearam limites globais de produção, resultando num regime focado em reciclagem e gestão de resíduos, frustrando ambientalistas.", 
                themes: "Meio Ambiente", 
                meta: "Fonte: Guardian", 
                region: "Ásia e Oceania", 
                theme: "Meio Ambiente", 
                tags: ["Poluição", "Tratado", "ONU"],
                politicalView: {
                    left: "Considera o resultado um fracasso capitulado às grandes corporações. Defende limites rígidos de produção e responsabilização total da indústria petroquímica.",
                    right: "Defende que a inovação tecnológica e a reciclagem são soluções melhores que a proibição da produção, protegendo empregos e o desenvolvimento industrial."
                }
            },
            { 
                id: 11, 
                dateIso: "2025-12-08", 
                category: "Comércio", 
                title: "Índia-EFTA: Novo Modelo", 
                imageUrl: "https://external-preview.redd.it/india-four-nation-efta-set-to-sign-free-trade-agreement-to-v0-F2WN-NnjWHot3tw3BDsGWsOZ4b2p-fvXY8N-J4u_wLk.jpg?auto=webp&s=bf4f0289118934791546ca2f211b20ee2d7e519d", 
                summary: "O acordo Índia-EFTA vincula acesso a mercado a compromissos de investimento direto.", 
                fullText: "A Índia e a EFTA finalizaram um acordo comercial inovador onde a redução de tarifas indianas está condicionada a um compromisso da EFTA de investir US$ 100 bilhões na Índia em 15 anos, criando um precedente para o 'comércio desenvolvimentista'.", 
                themes: "Comércio", 
                meta: "Fonte: Hindu", 
                region: "Ásia e Oceania", 
                theme: "Economia e Comércio", 
                tags: ["Índia", "EFTA", "Investimento"],
                politicalView: {
                    left: "Elogia a exigência de contrapartidas de investimento real e geração de empregos, vendo como um modelo para o Sul Global negociar com potências.",
                    right: "Vê com ceticismo o 'gerenciamento de comércio' estatal. Prefere que o fluxo de investimentos seja ditado pela atratividade do mercado, não por obrigações contratuais."
                }
            },
            { 
                id: 12, 
                dateIso: "2025-12-06", 
                category: "Segurança", 
                title: "Japão e Coreia do Sul: Radares", 
                imageUrl: "https://external-preview.redd.it/japan-south-korea-near-agreement-on-defense-minister-visits-v0-NySwcXTyvejDvKdVWGXMxL02nS-0n4iEmLAk6lIrINo.jpeg?width=640&crop=smart&auto=webp&s=ff226cabb921e1a31a81e4b81acef1153b2018bd", 
                summary: "A cooperação militar Tóquio-Seul, mediada pelos EUA, é um exemplo de Neorealismo Defensivo.", 
                fullText: "Japão e Coreia do Sul ativaram um sistema de compartilhamento de dados de radares em tempo real para monitorar mísseis da Coreia do Norte. A aproximação histórica, superando ressentimentos coloniais, visa conter a ameaça comum e a ascensão chinesa.", 
                themes: "Segurança", 
                meta: "Fonte: Kyodo", 
                region: "Ásia e Oceania", 
                theme: "Segurança e Paz", 
                tags: ["Japão", "Coreia", "EUA"],
                politicalView: {
                    left: "Teme que a militarização da região e a formação de blocos estilo 'mini-OTAN' aumentem as tensões e a corrida armamentista na Ásia-Pacífico.",
                    right: "Apoia fortemente a aliança das democracias liberais contra regimes autocráticos (China/Coreia do Norte), defendendo a 'paz através da força'."
                }
            },
            { 
                id: 13, 
                dateIso: "2025-12-10", 
                category: "Economia", 
                title: "Argentina e OCDE", 
                imageUrl: "https://www.moneytimes.com.br/uploads/2023/12/argentina-javier-milei-ocde.webp", 
                summary: "A busca da Argentina pela OCDE via reformas liberais exemplifica o uso de instituições.", 
                fullText: "Em um passo decisivo, a Argentina aceitou formalmente o convite para iniciar o processo de acessão à OCDE. O governo Milei aposta que o selo de 'boas práticas' da organização atrairá investimentos e ancorará suas reformas desregulamentadoras.", 
                themes: "Economia", 
                meta: "Fonte: Clarín", 
                region: "América do Sul", 
                theme: "Economia e Comércio", 
                tags: ["Argentina", "OCDE", "Milei"],
                politicalView: {
                    left: "Critica a adesão como submissão a políticas neoliberais de austeridade que prejudicam os trabalhadores e aumentam a desigualdade social.",
                    right: "Vê a entrada na OCDE como selo de qualidade institucional, essencial para modernizar a economia, atrair capital estrangeiro e reduzir o risco-país."
                }
            },
            { 
                id: 14, 
                dateIso: "2025-12-04", 
                category: "Espaço", 
                title: "Geopolítica Lunar: Bloco Chinês", 
                imageUrl: "https://clickpetroleoegas.com.br/wp-content/uploads/2024/10/China-surpreende-o-mundo-com-criacao-de-tijolos-lunares-e-da-inicio-ao-ambicioso-plano-de-construir-a-primeira-base-permanente-na-Lua.jpg", 
                summary: "A expansão da ILRS chinesa marca a disputa normativa na governança espacial.", 
                fullText: "A China formalizou a entrada de novos parceiros (Egito e Etiópia) na Estação Internacional de Pesquisa Lunar (ILRS), competindo diretamente com os Acordos Artemis liderados pelos EUA. A disputa não é apenas tecnológica, mas sobre quem escreverá as regras de exploração e mineração espacial.", 
                themes: "Geopolítica", 
                meta: "Fonte: SpaceNews", 
                region: "Ásia e Oceania", 
                theme: "Governança Global", 
                tags: ["China", "Espaço", "Lua"],
                politicalView: {
                    left: "Defende que o espaço deve ser 'patrimônio comum da humanidade', rejeitando a apropriação de recursos e a militarização por qualquer bloco (EUA ou China).",
                    right: "Enxerga a corrida espacial como nova fronteira de competição estratégica. Defende investimentos maciços para garantir a supremacia tecnológica ocidental."
                }
            },
            { 
                id: 15, 
                dateIso: "2025-12-07", 
                category: "África", 
                title: "Sahel: Ruptura Monetária", 
                imageUrl: "https://assets.brasildefato.com.br/2025/02/image_processing20250130-804602-f16tm0.webp", 
                summary: "A saída do Franco CFA pela Aliança do Sahel é um ato Pós-Colonial e Construtivista.", 
                fullText: "Os ministros de finanças de Mali, Níger e Burkina Faso recomendaram a criação de uma moeda comum, abandonando o Franco CFA. A medida é vista como o passo final na ruptura com a influência francesa, buscando soberania monetária total.", 
                themes: "África", 
                meta: "Fonte: Jeune Afrique", 
                region: "África", 
                theme: "Economia e Comércio", 
                tags: ["Sahel", "Moeda", "Colonialismo"],
                politicalView: {
                    left: "Celebra o fim do Franco CFA como uma vitória anticolonial necessária para a verdadeira independência econômica e soberania dos povos africanos.",
                    right: "Alerta para os riscos de instabilidade econômica e inflação sem o lastro europeu, vendo a medida como populismo que pode isolar economicamente a região."
                }
            },
            { 
                id: 16, 
                dateIso: "2025-12-05", 
                category: "Saúde", 
                title: "Impasse na OMS", 
                imageUrl: "https://i0.wp.com/nuevodiario-assets.s3.us-east-2.amazonaws.com/wp-content/uploads/2025/08/Sede-OMS-002.jpg?fit=1200%2C811&quality=100&ssl=1", 
                summary: "O bloqueio do Tratado Pandêmico expõe a divisão Norte-Sul.", 
                fullText: "A rodada final de negociações do Tratado Pandêmico da OMS terminou em impasse. Países em desenvolvimento exigem garantias de acesso equitativo a vacinas e quebra de patentes, enquanto nações ricas, sede das grandes farmacêuticas, defendem os direitos de propriedade intelectual.", 
                themes: "Saúde", 
                meta: "Fonte: Reuters", 
                region: "Europa", 
                theme: "Governança Global", 
                tags: ["OMS", "Pandemia", "Norte-Sul"],
                politicalView: {
                    left: "Saúde é direito humano, não mercadoria. Defende a quebra de patentes (waiver) em emergências globais e critica o lucro das 'Big Pharma'.",
                    right: "A proteção à propriedade intelectual é vital para financiar a inovação. A quebra de patentes desestimularia o investimento privado em novas curas."
                }
            },
            { 
                id: 17, 
                dateIso: "2025-12-09", 
                category: "Segurança", 
                title: "Irã e o TNP", 
                imageUrl: "https://admin.cnnbrasil.com.br/wp-content/uploads/sites/12/2025/01/2025-01-31T182422Z_1_LYNXNPEL0U0SL_RTROPTP_4_IRAN-NUCLEAR-E3.jpg?w=1024", 
                summary: "A expansão nuclear do Irã agrava o Dilema de Segurança regional.", 
                fullText: "O Diretor-Geral da AIEA reportou que o Irã aumentou seu estoque de urânio enriquecido a níveis próximos ao grau militar. Teerã alega fins pacíficos, mas potências ocidentais veem violação do TNP, discutindo novas sanções ou 'snapback' de resoluções da ONU.", 
                themes: "Segurança", 
                meta: "Fonte: Le Monde", 
                region: "Oriente Médio", 
                theme: "Segurança e Paz", 
                tags: ["Irã", "Nuclear", "AIEA"],
                politicalView: {
                    left: "Critica o isolamento do Irã e a saída dos EUA do acordo (JCPOA) como causas da escalada. Defende o retorno à diplomacia e ao desarmamento global.",
                    right: "Vê o Irã como ameaça existencial. Defende 'pressão máxima', sanções severas e não descarta ação militar preventiva para impedir a bomba."
                }
            },
            { 
                id: 18, 
                dateIso: "2025-12-03", 
                category: "Comércio", 
                title: "EUA-UE: Friendshoring", 
                imageUrl: "https://www.infomoney.com.br/wp-content/uploads/2025/07/2025-07-01T091249Z_881576995_RC2KDFAKV9WX_RTRMADP_3_USA-TRUMP-TARIFFS-EU-NEGOTIATION.jpg?quality=50&strip=all", 
                summary: "A trégua tarifária EUA-UE exemplifica o 'Friendshoring'.", 
                fullText: "Estados Unidos e União Europeia estenderam a suspensão de tarifas sobre aço e alumínio, buscando formar um 'clube do aço verde' para combater o excesso de capacidade da China. A medida consolida a tendência de 'friendshoring', priorizando comércio entre aliados geopolíticos.", 
                themes: "Comércio", 
                meta: "Fonte: Politico", 
                region: "América do Norte", 
                theme: "Economia e Comércio", 
                tags: ["EUA", "UE", "Aço"],
                politicalView: {
                    left: "Apoia a taxação de carbono e proteção de empregos locais, mas critica o protecionismo disfarçado que exclui países em desenvolvimento do comércio.",
                    right: "Defende o protecionismo estratégico para revitalizar a indústria nacional e reduzir a dependência de rivais geopolíticos (China), priorizando a segurança nacional."
                }
            },
            { 
                id: 19, 
                dateIso: "2025-12-11", 
                category: "Haiti", 
                title: "Crise da Missão MSS", 
                imageUrl: "https://www.defesanet.com.br/wp-content/uploads/2025/10/2025-FYI-10-08-22-Defesanet-Skybot.jpg", 
                summary: "A insolvência da missão no Haiti expõe os limites das intervenções.", 
                fullText: "A Missão Multinacional de Apoio à Segurança (MSS) no Haiti, liderada pelo Quênia, enfrenta falta de financiamento crítico. A ONU discute transformar a missão voluntária em uma operação de paz oficial (Capacetes Azuis) para garantir orçamento, enfrentando ceticismo da Rússia e China.", 
                themes: "Segurança", 
                meta: "Fonte: Miami Herald", 
                region: "América Central e Caribe", 
                theme: "Segurança e Paz", 
                tags: ["Haiti", "ONU", "Intervenção"],
                politicalView: {
                    left: "Cética quanto a intervenções militares estrangeiras, citando fracassos passados (Minustah). Defende soluções lideradas por haitianos e ajuda humanitária massiva.",
                    right: "Defende a intervenção robusta para restaurar a ordem e impedir o fluxo de refugiados, argumentando que o Haiti é um 'estado falido' que ameaça a região."
                }
            },
            { 
                id: 20, 
                dateIso: "2025-12-02", 
                category: "Dívida", 
                title: "FMI: Crise no Sul Global", 
                imageUrl: "https://imagenes.elpais.com/resizer/v2/EDW2YILV3XPDQV2OB7IAQOA2WU.jpg?auth=511244ba223dc62151d9b0ddffc9d0ae3493b85049e96394cada1e94adcafaa1&width=1960&height=1103&smart=true", 
                summary: "O alerta do FMI sobre a dívida destaca a fragmentação financeira.", 
                fullText: "O Fundo Monetário Internacional alertou que 60% dos países de baixa renda estão em risco de superendividamento. A instituição pede reformas no Marco Comum do G20 para acelerar reestruturações, criticando a lentidão dos credores bilaterais (como a China) e privados.", 
                themes: "Economia", 
                meta: "Fonte: IMF", 
                region: "África", 
                theme: "Economia e Comércio", 
                tags: ["FMI", "Dívida", "Sul Global"],
                politicalView: {
                    left: "Critica o FMI por impor austeridade. Defende o perdão da dívida e reforma da arquitetura financeira global para dar mais voz ao Sul Global.",
                    right: "Insiste na responsabilidade fiscal e reformas estruturais nos países devedores como condição para ajuda, para evitar o risco moral (moral hazard)."
                }
            }
        ];

        // --- ENRICHMENT LOGIC (Preenchendo campos padrão) ---
        newsData = newsData.map(item => ({
            ...item,
            examAnalysis: `
                <p><strong>Frequência:</strong> Alta nos últimos 3 anos.</p>
                <p><strong>Como cai:</strong> A banca costuma cobrar a relação entre ${item.category} e os princípios do Direito Internacional Público. Atenção especial à posição do Brasil.</p>
            `,
            historicalContext: `
                <p>Para compreender o atual cenário de <strong>${item.title}</strong>, é necessário recuar à década passada. Historicamente, este tema tem sido um ponto de inflexão nas relações ${item.region}.</p>
                <p>Eventos chave:</p>
                <ul>
                    <li>2015: Início das negociações multilaterais.</li>
                    <li>2020: Mudança de paradigma com a crise sanitária.</li>
                    <li>2024: Consolidação da nova diretriz política.</li>
                </ul>
            `,
            teacherAnalysis: `
                <p>O ponto central aqui não é apenas o fato noticioso, mas o <strong>precedente</strong> que ele abre. Observem como ${item.tags[0]} interage com ${item.tags[1] || 'o sistema internacional'}.</p>
                <p>Do ponto de vista realista, vemos uma clara busca por poder relativo. Já sob a ótica liberal, as instituições estão sendo testadas.</p>
            `,
            keyPoints: `
                <div class="p-3 bg-white border border-slate-200 rounded shadow-sm"><strong>Ponto 1:</strong> Impacto imediato na balança de poder regional.</div>
                <div class="p-3 bg-white border border-slate-200 rounded shadow-sm"><strong>Ponto 2:</strong> Reação dos mercados emergentes.</div>
                <div class="p-3 bg-white border border-slate-200 rounded shadow-sm"><strong>Ponto 3:</strong> Desafio às normas estabelecidas pela ONU.</div>
            `,
            glossary: `
                <div><strong class="text-brand-gold">Soft Power:</strong> Capacidade de influenciar sem coerção.</div>
                <div><strong class="text-brand-gold">Realpolitik:</strong> Política baseada em poder e considerações materiais.</div>
                <div><strong class="text-brand-gold">Multilateralismo:</strong> Cooperação entre 3 ou mais estados.</div>
            `
        }));

        let activeFilters = { region: [], theme: [], tags: [] };

        // --- INIT ---
        document.addEventListener('DOMContentLoaded', () => {
            renderFilters();
            renderFeed();
            document.getElementById('currentDateDisplay').textContent = new Date().toLocaleDateString('pt-BR', { weekday: 'long', day: 'numeric', month: 'long' });
            
            // Search Listener
            document.getElementById('searchInput').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = newsData.filter(n => n.title.toLowerCase().includes(term) || n.summary.toLowerCase().includes(term));
                renderFeed(filtered);
            });
        });

        // --- RENDER FILTERS ---
        function renderFilters() {
            // Regions
            const rContainer = document.getElementById('regionFilters');
            rContainer.innerHTML = REGIONS.map(r => `
                <label class="flex items-center gap-2 cursor-pointer hover:bg-slate-50 p-1 rounded transition-colors">
                    <input type="checkbox" value="${r}" onchange="toggleFilter('region', '${r}')" class="rounded border-slate-300 text-brand-gold focus:ring-brand-gold">
                    <span class="text-sm text-slate-600">${r}</span>
                </label>
            `).join('');

            // Themes
            const tContainer = document.getElementById('themeFilters');
            tContainer.innerHTML = THEMES.map(t => `
                <label class="flex items-center gap-2 cursor-pointer hover:bg-slate-50 p-1 rounded transition-colors">
                    <input type="checkbox" value="${t}" onchange="toggleFilter('theme', '${t}')" class="rounded border-slate-300 text-brand-gold focus:ring-brand-gold">
                    <span class="text-sm text-slate-600">${t}</span>
                </label>
            `).join('');

            // Tags (Dynamic top 15)
            const allTags = newsData.flatMap(n => n.tags);
            const uniqueTags = [...new Set(allTags)].slice(0, 15);
            const tagContainer = document.getElementById('tagFilters');
            tagContainer.innerHTML = uniqueTags.map(tag => `
                <button onclick="toggleTag('${tag}', this)" class="px-2 py-1 text-xs border border-slate-200 rounded-full text-slate-500 hover:border-brand-gold hover:text-brand-gold transition-all">
                    #${tag}
                </button>
            `).join('');

            // Clone for Mobile
            document.getElementById('mobileFiltersTarget').innerHTML = rContainer.innerHTML + '<hr class="my-4">' + tContainer.innerHTML;
        }

        // --- FILTER LOGIC ---
        function toggleFilter(type, value) {
            const index = activeFilters[type].indexOf(value);
            if (index > -1) activeFilters[type].splice(index, 1);
            else activeFilters[type].push(value);
            applyFilters();
        }

        function toggleTag(tag, btn) {
            const index = activeFilters.tags.indexOf(tag);
            if (index > -1) {
                activeFilters.tags.splice(index, 1);
                btn.classList.remove('bg-brand-gold', 'text-white', 'border-transparent');
                btn.classList.add('text-slate-500', 'border-slate-200');
            } else {
                activeFilters.tags.push(tag);
                btn.classList.add('bg-brand-gold', 'text-white', 'border-transparent');
                btn.classList.remove('text-slate-500', 'border-slate-200');
            }
            applyFilters();
        }

        function applyFilters() {
            let filtered = newsData;

            if (activeFilters.region.length > 0) {
                filtered = filtered.filter(n => activeFilters.region.includes(n.region));
            }
            if (activeFilters.theme.length > 0) {
                filtered = filtered.filter(n => activeFilters.theme.includes(n.theme));
            }
            if (activeFilters.tags.length > 0) {
                filtered = filtered.filter(n => n.tags.some(t => activeFilters.tags.includes(t)));
            }
            renderFeed(filtered);
        }

        function clearFilters() {
            activeFilters = { region: [], theme: [], tags: [] };
            document.querySelectorAll('input[type="checkbox"]').forEach(el => el.checked = false);
            renderFeed();
        }

        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            menu.classList.toggle('-translate-x-full');
        }

        // --- RENDER FEED ---
        function renderFeed(data = newsData) {
            const grid = document.getElementById('feedGrid');
            const empty = document.getElementById('emptyState');
            const count = document.getElementById('newsCount');
            
            count.innerText = data.length;
            grid.innerHTML = '';

            if (data.length === 0) {
                empty.classList.remove('hidden');
                return;
            } else {
                empty.classList.add('hidden');
            }

            data.forEach(item => {
                const img = localStorage.getItem(`img-${item.id}`) || item.imageUrl;
                
                const card = document.createElement('article');
                card.className = "flex flex-col bg-white rounded-lg border border-slate-200 overflow-hidden hover:shadow-card-hover transition-all duration-300 group cursor-pointer h-full";
                card.onclick = () => openNewsModal(item.id);

                card.innerHTML = `
                    <div class="relative h-48 overflow-hidden">
                        <img src="${img}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105" alt="${item.title}" onerror="this.src='https://placehold.co/600x400/eee/999?text=UbiNews'">
                        <div class="absolute top-3 left-3">
                            <span class="px-2 py-1 bg-brand-gold text-white text-[10px] font-bold uppercase tracking-widest shadow-sm rounded-sm">${item.category}</span>
                        </div>
                    </div>
                    <div class="p-5 flex flex-col flex-1">
                        <div class="flex gap-2 mb-3 text-[10px] font-bold uppercase text-slate-400 tracking-wide">
                            <span>${item.region}</span>
                            <span>•</span>
                            <span>${new Date(item.dateIso).toLocaleDateString('pt-BR')}</span>
                        </div>
                        <h3 class="font-serif font-bold text-xl text-slate-900 leading-tight mb-2 group-hover:text-brand-gold transition-colors">
                            ${item.title}
                        </h3>
                        <p class="text-sm text-slate-500 line-clamp-3 mb-4 font-sans leading-relaxed">
                            ${item.summary}
                        </p>
                        <div class="mt-auto flex items-center justify-between border-t border-slate-100 pt-4">
                            <div class="flex gap-1">
                                ${item.tags.slice(0, 2).map(t => `<span class="text-[10px] bg-slate-100 px-2 py-1 rounded text-slate-600">#${t}</span>`).join('')}
                            </div>
                            <i class="fas fa-arrow-right text-slate-300 group-hover:text-brand-gold transition-colors transform group-hover:translate-x-1"></i>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // --- MODAL LOGIC ---
        let currentNews = null;

        function openNewsModal(id) {
            const item = newsData.find(n => n.id === id);
            currentNews = item;
            const savedImg = localStorage.getItem(`img-${id}`) || item.imageUrl;

            // Populate Hero
            document.getElementById('modalHeroImg').src = savedImg;
            document.getElementById('modalTitle').textContent = item.title;
            document.getElementById('modalSubtitle').textContent = item.summary;
            document.getElementById('modalCategory').textContent = item.category;
            document.getElementById('modalDate').textContent = new Date(item.dateIso).toLocaleDateString('pt-BR', {weekday: 'long', day: 'numeric', month: 'long', year: 'numeric'});

            // Populate Content Areas
            document.getElementById('modalSummary').innerHTML = `<p>${item.summary}</p>`;
            document.getElementById('modalFullText').innerHTML = item.fullText.replace(/\n\n/g, '<br><br>');
            
            // Populate Enrichment Tabs
            document.getElementById('modalExamAnalysis').innerHTML = item.examAnalysis;
            document.getElementById('modalTeacherAnalysis').innerHTML = item.teacherAnalysis;
            document.getElementById('modalHistoricalText').innerHTML = item.historicalContext;
            document.getElementById('modalKeyPoints').innerHTML = item.keyPoints;
            document.getElementById('modalGlossary').innerHTML = item.glossary;

            // --- POPULATE POLITICAL SPECTRUM (DYNAMIC) ---
            const spectrumContainer = document.getElementById('modalSpectrum');
            if (item.politicalView) {
                spectrumContainer.innerHTML = `
                    <div class="p-3 bg-red-50 rounded-lg border border-red-100 hover:shadow-sm transition-shadow">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 rounded-full bg-red-500 animate-pulse"></span>
                            <strong class="text-xs uppercase text-red-700 font-bold tracking-wider">Visão Progressista</strong>
                        </div>
                        <p class="text-xs text-slate-700 leading-relaxed font-medium">${item.politicalView.left}</p>
                    </div>
                    
                    <div class="p-3 bg-blue-50 rounded-lg border border-blue-100 hover:shadow-sm transition-shadow">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="w-2 h-2 rounded-full bg-blue-500 animate-pulse"></span>
                            <strong class="text-xs uppercase text-blue-700 font-bold tracking-wider">Visão Conservadora</strong>
                        </div>
                        <p class="text-xs text-slate-700 leading-relaxed font-medium">${item.politicalView.right}</p>
                    </div>
                    <button class="text-xs font-bold text-brand-gold mt-1 hover:underline w-full text-right">Ler análise aprofundada <i class="fas fa-arrow-right ml-1"></i></button>
                `;
            } else {
                spectrumContainer.innerHTML = '<p class="text-xs text-slate-400 italic">Análise de espectro não disponível para este tópico.</p>';
            }

            // People Tags (Simulation)
            document.getElementById('modalPeople').innerHTML = ['António Guterres', 'Lula da Silva', 'Joe Biden'].map(p => 
                `<span class="px-3 py-1 border border-slate-300 rounded-full text-xs font-bold text-slate-600 hover:bg-slate-100 cursor-pointer transition-colors">${p}</span>`
            ).join('');

            // Disciplines
            document.getElementById('modalDisciplines').innerHTML = ['Política Internacional', 'História Mundial', 'Geografia'].map(d => 
                `<span class="text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded">${d}</span>`
            ).join('');

            // Reset Tab
            switchTab('tab-resumo');

            // Show
            const modal = document.getElementById('newsModal');
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        function closeNewsModal() {
            document.getElementById('newsModal').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        function switchTab(tabId) {
            // Hide all
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => {
                el.classList.remove('active', 'border-brand-gold', 'text-brand-gold');
                el.classList.add('border-transparent', 'text-slate-500');
            });

            // Show target
            document.getElementById(tabId).classList.add('active');
            
            // Highlight Button
            const btn = Array.from(document.querySelectorAll('.tab-btn')).find(b => b.getAttribute('onclick').includes(tabId));
            if(btn) {
                btn.classList.add('active', 'border-brand-gold', 'text-brand-gold');
                btn.classList.remove('border-transparent', 'text-slate-500');
            }
        }

        // --- GOOGLE TRANSLATE (Fixed) ---
        function translateContent(lang) {
            // Encontra o elemento select oculto do Google Translate
            const select = document.querySelector(".goog-te-combo");
            
            if (select) {
                // Define o valor e dispara o evento de mudança
                select.value = lang;
                select.dispatchEvent(new Event("change"));
            } else {
                // Fallback caso o script ainda não tenha carregado
                alert("O sistema de tradução está inicializando. Tente novamente em alguns segundos.");
            }
        }

        // Init Google Translate
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'pt',
                includedLanguages: 'en,es,fr,pt',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                autoDisplay: false
            }, 'google_translate_element_header');
        }
    </script>
    <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>
